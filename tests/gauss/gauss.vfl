
# create a model.
mdl = vfr(
  alpha0: 100,
  beta0: 100,
  nu: 1e-2,
  data: data(file: 'gauss.dat'),
  factors: [decay(alpha: 10, beta: 1000),
            impulse(mu:  60, tau: 0.01),
            impulse(mu: 180, tau: 0.01)]
);

# create a full-gradient optimizer.
opt = fg(model: mdl);
opt.execute();

# build gridded datasets for prediction.
G = [[0, 1, 300]];
mean = data(grid: G);
var = data(grid: G);

# compute the model prediction.
mdl.predict(mean: mean, var: var);

# write the prediction results.
mean.write(file: 'mean.dat');
var.write(file: 'var.dat');

