
# create a model.
mdl = vfr(
  alpha0: 10,
  beta0: 40,
  nu: 1e-3,
  data: data(file: 'multexp.dat'),
  factors: [decay(alpha: 10, beta:     1),
            decay(alpha: 10, beta:    10),
            decay(alpha: 10, beta:   100),
            decay(alpha: 10, beta:  1000),
            decay(alpha: 10, beta: 10000)]
);

# create a full-gradient optimizer.
opt = fg(model: mdl, lipschitzInit: 0.001);
opt.execute();

# build gridded datasets for prediction.
G = [[0, 0.1, 150]];
mean = data(grid: G);
var = data(grid: G);

# compute the model prediction.
mdl.predict(mean: mean, var: var);

# write the prediction results.
mean.write(file: 'mean.dat');
var.write(file: 'var.dat');

